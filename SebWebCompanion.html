<!DOCTYPE html>
<html>
<head>
	<link rel="icon" href="https://art.pixilart.com/sr5zfaad98ce16aws3.png" type="image/x-icon"/>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;700&display=swap&family=Fredoka:wght@300..700&family=Press+Start+2P&display=swap" rel="stylesheet">

	<meta charset="UTF-8">
	<title>SebWeb Companion</title>

	<style>
		body {
			margin: 0;
			font-family: 'Press Start 2P', serif;
			background: url('https://www.topgear.com/sites/default/files/2021/08/04%20DSC06357.jpg') no-repeat center center fixed;
			background-size: cover;
			color: white;
			height: 100vh;
			display: flex;
			justify-content: center;
			align-items: center;
		}

		.chatbox {
			width: 75%;
			max-width: 1000px;
			height: 70vh;
			padding: 16px;
			border-radius: 16px;
			background: rgba(255, 255, 255, 0.1);
			backdrop-filter: blur(10px);
			border: 1px solid rgba(255, 255, 255, 0.2);
			box-shadow: 0 4px 30px rgba(0,0,0,0.3);
			display: flex;
			flex-direction: column;
		}

		.messages {
			flex: 1;
			overflow-y: auto;
			display: flex;
			flex-direction: column;
			gap: 10px;
			margin-bottom: 12px;
			padding-right: 4px;
		}

		.msg {
			padding: 10px;
			border-radius: 10px;
			max-width: 75%;
			white-space: pre-wrap;
			line-height: 1.4;
			word-break: break-word;
			overflow-wrap: anywhere;
		}

		.user { align-self: flex-end; background: #3b82f6; color: white; }
		.bot { align-self: flex-start; background: #0f172a; border: 1px solid #334155; }

		.input-area {
			display: flex;
			gap: 8px;
		}

		input {
			flex: 1;
			padding: 10px;
			border-radius: 8px;
			border: 1px solid #334155;
			background: rgba(15,23,42,0.8);
			color: white;
			font-family: 'Press Start 2P', serif;
		}

		button {
			background: #3b82f6;
			color: white;
			border: none;
			padding: 10px 14px;
			border-radius: 8px;
			cursor: pointer;
			font-family: 'Press Start 2P', serif;
		}

		#backButtonContainer {
			position: absolute;
			top: 50px;
			left: 50%;
			transform: translateX(-50%);
			text-align: center;
			width: auto;
		}

		#backButton {
			background: rgba(255, 255, 255, 0.15);
			backdrop-filter: blur(10px);
			padding: 10px 16px;
			border-radius: 12px;
			border: 1px solid rgba(255,255,255,0.2);
			color: white;
			font-family: 'Press Start 2P';
			cursor: pointer;
			box-shadow: 0 4px 30px rgba(0,0,0,0.3);
		}

		button:hover { background: #2563eb; }
	</style>
</head>

<body>

<div id="backButtonContainer">
	<button id="backButton" onclick="window.location.href='index.html'">
		← Back to New Tab
	</button>
</div>

<div class="chatbox">
	<div class="messages" id="messages"></div>
	<div class="input-area">
		<input id="input" placeholder="Say something..." />
		<button id="send">Send</button>
	</div>
</div>

<script>
	const messagesEl = document.getElementById("messages");
	const inputEl = document.getElementById("input");

	const responses = [
		{ mode: "any", triggers: ["hello", "hi"], reply: "Hello! How are you?" },
		{ mode: "any", triggers: ["joke"], reply: "Why did the web developer go broke? Because he used up all his cache!" },
		{ mode: "any", triggers: ["day","weekday"], reply: "Today is {day}." },
		{ mode: "any", triggers: ["date","today"], reply: "Today's date is {date}." },
		{ mode: "any", triggers: ["time","clock"], reply: "The current time is {time}." },
		{ mode: "all", triggers: ["generate","code"], reply: "Sorry, I don't have the ability generate code yet." },
		{ mode: "any", triggers: ["love 67","love the meme 67","love the number 67","like 67","like the meme 67","like the number 67"], reply: "67 is terrible bro."},
		{ mode: "all", triggers: ["your","creator"], reply: "Seb is my creator, and his platform is SebWeb." }
	];

	function getDayOfWeek() {
		const days = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
		return days[new Date().getDay()];
	}

	function getDate() { return new Date().toLocaleDateString(); }
	function getTime() { return new Date().toLocaleTimeString(); }

	function addMsg(role, text) {
		const div = document.createElement("div");
		div.className = "msg " + role;
		div.textContent = text;
		messagesEl.appendChild(div);
		messagesEl.scrollTop = messagesEl.scrollHeight;
	}

	// --- UNSPLASH WORKING IMAGE GENERATOR ---
	function addStockImage(prompt) {
    if (!prompt) return;

    const placeholder = document.createElement("div");
    placeholder.textContent = "Loading image...";
    placeholder.style.color = "#aaa";
    messagesEl.appendChild(placeholder);

    const API_KEY = "53550570-4506818d5990869df7d597f9a"; // ← put your real key here
    const url = `https://pixabay.com/api/?key=${API_KEY}&q=${encodeURIComponent(prompt)}&image_type=photo&per_page=3`;

    fetch(url)
        .then(res => res.json())
        .then(data => {
            messagesEl.removeChild(placeholder);

            if (!data.hits || data.hits.length === 0) {
                addMsg("bot", "No images found.");
                return;
            }

            const img = new Image();
            img.src = data.hits[0].webformatURL;
            img.style.maxWidth = "100%";
            img.style.borderRadius = "10px";
            img.style.marginTop = "5px";

            img.onload = () => {
                messagesEl.appendChild(img);
                messagesEl.scrollTop = messagesEl.scrollHeight;
				img.style.maxWidth = "80%";
				img.style.height = "80%";
				img.style.borderRadius = "10px";
				img.style.marginTop = "5px";

            };

            img.onerror = () => {
                addMsg("bot", "Image failed to load.");
            };
        })
        .catch(() => {
            messagesEl.removeChild(placeholder);
            addMsg("bot", "Error loading image.");
        });
}


	function getReply(text) {
		const lower = text.toLowerCase();
		const replies = [];

		for (const r of responses) {
			const match = r.mode === "any"
				? r.triggers.some(t => lower.includes(t))
				: r.triggers.every(t => lower.includes(t));

			if (match) {
				replies.push(
					r.reply
						.replace("{day}", getDayOfWeek())
						.replace("{date}", getDate())
						.replace("{time}", getTime())
				);
			}
		}

		return replies.length ? replies.join("\n") : "Sorry, I don't understand that yet.";
	}

function send() {
  const text = inputEl.value.trim();
  if (!text) return;

  addMsg("user", text);
  inputEl.value = "";

  const lower = text.toLowerCase();
  const trigger = "make me an image of";

  // Handle image command anywhere in sentence
  if (lower.includes(trigger)) {
    const prompt = text.substring(lower.indexOf(trigger) + trigger.length).trim();

    if (prompt.length > 0) {
      addStockImage(prompt);
    } else {
      addMsg("bot", "Please specify what you want an image of.");
    }
    return; // Stop normal replies
  }

  // Normal chatbot response
  const reply = getReply(text);
  addMsg("bot", reply);
}

	inputEl.addEventListener("keydown", e => { if (e.key === "Enter") send(); });
	document.getElementById("send").addEventListener("click", send);
</script>

</body>
</html>
